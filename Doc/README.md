
## 项目概览

在具有低成本，轻量化，可部署性强等特点下。该机载机械臂平台能够保持平台在平面上维持位置相对稳定下实现快速准确的抓取

本项目是 使用STM32+Clion+stm32cubemx 开发的项目

嵌入式软件框架为 FreeRTOS heap_4

如机械结构建模所示，项目采用单关节电机+单夹爪电机的方式驱动机械臂

机械臂电机控制：FOC算法+BLDC电机+外环PID做折叠臂闭环控制

HMI：基于ELRS的遥控器，调试用串口日志收发任务和状态切换与状态指示用按键与亮灯任务

传感器：BLDC电机磁编码器+“激光模块+超声波模块”双模态单向融合测距

目标识别：外部摄像头视觉模块（单独主控）实现目标识别定位与指令收发

## 硬件接线

### 关节电机 - 酷点MG310

|   硬件 针脚   |   驱动 针脚   | 芯片 针脚 |
|:---------:|:---------:|:-----:|
| A相编码器输出输出 |    NA     |  PB6  |
| B相编码器输出输出 |    NA     |  PB7  |
|    M+     | AO1 - IN1 |  A11  |
|    M-     | AO2 - IN2 |  A10  |
|    NA     |    PWM    |  A9   |

#### 电机霍尔编码器 - AB相增量式编码器

## PID 电机控制
```markdown
目标角度 θ_target
↓
PID 计算 → 输出 PWM 值（-1000 ~ 1000）
↓
电机驱动 → 转速 ω ∝ |PWM|
↓
机械臂关节转动 → 实际角度 θ_feedback（编码器读取）
↓
反馈给PID → 误差 e = θ_target - θ_feedback
```

## LOG

### 11/4 night

**DONE**

把JointPID的事件回调函数写完了，理论上当程序启动，程序就会在100ms周期的TIM2中断回调中
先更新传感器（目前只有编码器）数据，再进入PID控制函数，计算PID输出并写入电机

**UNDONE**

MotorEncoder的调零函数还没写完，GROK的方案给了一个状态机调零的程序逻辑，明天把剩下的写完看看能不能跑通

1145141919810

### 11/5 afternoon

**DONE**

写完了调零程序，把限位判断注册到EXTI回调函数上去

**UNDONE**

EXTI回调函数还没写完

### 11/5 evening

测试:

**DONE**

1. 电机能动 OK
2. 霍尔编码器 OK
3. 调零 OK
4. 电机编码器能正常运行 OK
5. 调零 + PID OK

**UNDONE**

PID 调参, 挂个像样的负载做个场景测试.
电机控制demo全部测试完毕, 后续工作主要关注 电控板 和 FOC BLDC电机
没测串口指令接收中断
